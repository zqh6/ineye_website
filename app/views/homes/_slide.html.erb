<!--修改轮播-->
<div class='banner-box  marB10 main'>
    <ul class='img'>
        <li>
            <a href="javascript:;">
                <%= image_tag("banner_gyhd.jpg") %>
            </a>
        </li>
        <li>
            <a href="javascript:;">
                <%= image_tag("banner_gzdr.jpg") %>
            </a>
        </li>
        <li>
            <a href="http://mp.weixin.qq.com/s?__biz=MzU4MTA4MTQwMw==&mid=100000355&idx=2&sn=39c61867b3b98f6988a34502c3815f1d&chksm=7d4c42374a3bcb212cd931503646510eef358e1dfbe04278bc100036b96b20922c0491fb7068#rd">
                <%= image_tag("banner-cl.jpg") %>
            </a>
        </li>
        <li>
            <a href="https://mp.weixin.qq.com/s?__biz=MzU4MTA4MTQwMw==&mid=100000349&idx=1&sn=e5735970400c850ed09768c833a8e751&chksm=7d4c42094a3bcb1f0b071a7b046f8d0b645d26db504bfa0245392c0b988fbe68ed515725f43b#rd">
                <%= image_tag("banner-my.jpg") %>
            </a>
        </li>
        <li>
            <%= link_to image_tag("banner_qz.jpg"),news_path(:心系九寨) %>
        </li>
        <li>
            <%= link_to image_tag("kaiye_banner.jpg"),news_path(:成都中医大银海眼科医院隆重举行开业庆典仪式) %>
        </li>


    </ul>
    <ul class='li'></ul>
    <div class='but but-left'>&lt;</div>
    <div class='but but-right'>&gt;</div>
    <div class='bar'></div>
</div>
<!--修改轮播-->
<script type="text/javascript">
    if(oTime){
        clearInterval(oTime);
        oTime = null;
    }
    var oSj = 5000;
    var i = 0;
    var bar = $(".banner-box .bar");
    var w =$(".banner-box").width()
    var oImg = $(".banner-box .img");//获取图片盒子
    var s = $(".banner-box li").length;
    var num =6;
    if($(".banner-box .img li").size() <= num){
        var oImgfirst= $('.banner-box .img li:first').clone();//复制第一张图片
        oImg.append(oImgfirst);//将复制的第一张图片放到最后
        for (var j = 1; j <= num; j++) {
            $('.banner-box .li').append('<li></li>');
        }
    }

    var imgNum = 7;//获取图片数量

    //根据图片个数添加圆点按钮
    //给第一个按钮添加选中样式
    $('.banner-box .li li:first').addClass('index');


    //点击向右轮播
    $(".but-right").click(function(){
        int();
    });

    //点击向左轮播
    $(".but-left").click(function(){
        bar.stop().css('width',0);
        i--;
        if(i == -1){
            $('.banner-box .img').css('left',-(imgNum-1)*w);//用CSS进行图片位置变换，达到无缝拼接效果
            i = imgNum-2;
        }
        oImg.stop().animate({left:-i*w},500);//动画效果
        clearInterval(oTime);
        oTime = setInterval(function(){
            int();
        },oSj);
        barAniMate();//进度条函数动画效果
        $(".banner-box .li li").eq(i).addClass('index').siblings().removeClass('index');//给相应的按钮添加样式
    });

    //鼠标移动到圆点后轮播
    $(".banner-box .li li").hover(function() {
        clearInterval(oTime);//清除定时器
        bar.stop().css('width',0);
        var index = $(this).index();
        i=index;
        oImg.stop().animate({left:-index*w},500);//动画效果
        bar.stop().css('width',0);
        $(this).addClass('index').siblings().removeClass('index');//给相应的按钮添加样式
    },function(){
        barAniMate();//进度条函数动画效果
        oTime = setInterval(function(){
            int();
        },oSj);
    });

    //自动轮播
    var oTime = setInterval(function(){
        int();
    },oSj);

    barAniMate();//进度条函数动画效果

    //进度条函数动画效果
    function barAniMate(){
        bar.animate({width:'100%'},oSj,function(){
            $(this).css('width',0);
        });
    }

    //自动轮播函数
    function int(){
        bar.stop().css('width',0);
        i++;
        if(i == imgNum){
            oImg.css('left',0);//用CSS进行图片位置变换，达到无缝拼接效果
            i = 1;
        }
        oImg.stop().animate({left:-i*w},500);//动画效果
        barAniMate();//进度条函数动画效果
        clearInterval(oTime);
        oTime = setInterval(function(){
            int();
        },oSj);
        if(i == imgNum-1){
            $(".banner-box .li li").eq(0).addClass('index').siblings().removeClass('index');//给相应的按钮添加样式

        }else{
            $(".banner-box .li li").eq(i).addClass('index').siblings().removeClass('index');//给相应的按钮添加样式
        }
    }

</script>